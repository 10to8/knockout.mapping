// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.d=function(m,n){for(var i=m.split("."),l=window,j=0;j<i.length-1;j++)l=l[i[j]];l[i[i.length-1]]=n};ko.t=function(m,n,i){m[n]=i};
(function(){function m(a){if(a&&typeof a==="object"&&a.constructor==(new Date).constructor)return"date";return typeof a}function n(a){a=a||{};a.create=a.create||{};a.f=a.f||{};a.h=a.h||{};return a}function i(a,c,b,d,e,k){function q(f){var g;if(b.create[e]&&r(c)&&!h){n();g=b.create[e](c,k,e)}return g||f}var h=ko.a.c(c)instanceof Array;d=d||new t;if(d.e(c))return a;e=e||"";if(h){ko.u(a)||(a=q(ko.w([])));var o=function(f){return f};if(b.f[e])o=b.f[e];var y=x(b,e),u=[];z(ko.a.c(a),c,e,o,function(f,g){switch(f){case "added":var p=
ko.a.c(i(undefined,g,b,d,e,k));a.push(p);break;case "retained":p=j(a,l(g,o),o);i(p,g,b,d,e,k);break;case "deleted":p=j(a,l(g,o),o);a.remove(p)}u.push({event:f,item:p})});ko.a.k(y,function(f){ko.a.k(u,function(g){f(g.event,g.item)})})}else if(r(c)){ignoreProperties=[];if(!a){a=q({});s(a,function(f){ko.n(a[f])||(ignoreProperties[f]=true)})}d.save(c,a);s(c,function(f){if(!ignoreProperties[f]){var g=d.e(c[f]);a[f]=g?g:i(a[f],c[f],b,d,e?e+"."+f:f,a)}})}else{switch(m(c)){case "function":a=c;break;default:if(ko.n(a))a(ko.a.c(c));
else a=ko.v(ko.a.c(c))}d.save(c,a)}return a}function l(a,c){var b=a;if(c)b=c(a);return ko.a.c(b)}function j(a,c,b){a=ko.a.q(ko.a.c(a),function(d){return l(d,b)==c});if(a.length!=1)throw Error("When calling ko.update*, the key '"+c+"' was not found or not unique!");return a[0]}function v(a,c){return ko.a.r(ko.a.c(a),function(b){return c?l(b,c):b})}function z(a,c,b,d,e){b=v(c,d);var k=v(a,d);b=ko.a.s(k,b);k=0;for(var q=b.length;k<q;k++){var h=b[k];switch(h.status){case "added":h=j(ko.a.c(c),h.value,
d);e("added",h);break;case "retained":h=j(c,h.value,d);e("retained",h);break;case "deleted":h=j(ko.a.c(a),h.value,d);e("deleted",h)}}}function s(a,c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function r(a){return m(a)=="object"&&a!==null&&a!==undefined}function x(a,c){var b=a.h[c];if(b){b instanceof Array||(b=[b]);return b}else return[]}function w(a,c){c=c||new t;a=ko.a.c(a);if(!r(a))return a;c.save(a,a);s(a,function(b){var d=ko.a.c(a[b]);switch(m(d)){case "object":case "undefined":var e=
c.e(d);a[b]=e!==undefined?e:w(d,c);break;default:a[b]=ko.a.c(d)}});return a}function t(){var a=[],c=[];this.save=function(b,d){var e=ko.a.l(a,b);if(e>=0)c[e]=d;else{a.push(b);c.push(d)}};this.e=function(b){b=ko.a.l(a,b);return b>=0?c[b]:undefined}}ko.b={};ko.b.g=function(a,c){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");c=n(c);var b=i(undefined,a,c);b.__ko_mapping__=b.__ko_mapping__||{};b.__ko_mapping__=c;return b};ko.b.m=function(a,c){var b=ko.a.o(a);
return ko.b.g(b,c)};ko.b.j=function(a,c){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");var b=a.__ko_mapping__;if(!b)throw Error("The object you are trying to update was not created by a 'fromJS' or 'fromJSON' mapping!");return i(a,c,b)};ko.b.p=function(a,c,b){c=ko.a.o(c);return ko.b.j(a,c,b)};ko.b.i=function(a){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");
return w(a)};ko.b.toJSON=function(a){a=ko.b.i(a);return ko.a.z(a)};ko.d("ko.mapping",ko.b);ko.d("ko.mapping.fromJS",ko.b.g);ko.d("ko.mapping.fromJSON",ko.b.m);ko.d("ko.mapping.updateFromJS",ko.b.j);ko.d("ko.mapping.updateFromJSON",ko.b.p);ko.d("ko.mapping.toJS",ko.b.i);ko.d("ko.mapping.toJSON",ko.b.toJSON)})();
