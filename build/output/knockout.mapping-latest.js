// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.d=function(q,j){for(var i=q.split("."),k=window,l=0;l<i.length-1;l++)k=k[i[l]];k[i[i.length-1]]=j};ko.w=function(q,j,i){q[j]=i};
(function(){function q(){s=ko.e;ko.e=function(){var a=arguments,c,b={j:ko.n(false)},d=new s(function(){if(b.j()){if(!c){c=s.apply(this,a);b.e=c}return c()}});b.p=d;t.push(b);return d}}function j(a){if(a&&typeof a==="object"&&a.constructor==(new Date).constructor)return"date";return typeof a}function i(a,c,b){if(!u){t=[];q()}u++;a=k(a,c,b);u--;if(!u){ko.e=s;t.length&&v(a,function(d){var e=ko.a.s(t,function(f){return f.p==d},this);if(e){e.j(true);return e.e}else return d})}return a}function k(a,c,b,
d,e,f){var n=ko.a.c(c)instanceof Array;d=d||new w;if(d.f(c))return a;e=e||"";if(n){ko.z(a)||(a=ko.B([]));var h=[],o=function(g){return g};if(b[e]&&b[e].key)o=b[e].key;z(ko.a.c(a),c,o,function(g,m){switch(g){case "added":var p=ko.a.c(k(undefined,m,b,d,e,f));a.push(p);break;case "retained":p=r(a,l(m,o),o);k(p,m,b,d,e,f);break;case "deleted":p=r(a,l(m,o),o);a.remove(p)}h.push({event:g,item:p})});b[e]&&b[e].g&&ko.a.t(h,function(g){b[e].g(g.event,g.item)})}else if(j(c)=="object"&&c!==null&&c!==undefined){if(!a)if(b[e]&&
b[e].create instanceof Function)return b[e].create(c,f);else a={};d.save(c,a);x(c,function(g){var m=d.f(c[g]);a[g]=m?m:k(a[g],c[g],b,d,e?e+"."+g:g,a)})}else switch(j(c)){case "function":a=c;break;default:if(ko.A(a))a(ko.a.c(c));else a=ko.n(ko.a.c(c))}return a}function l(a,c){var b;if(c)b=c(a);b||(b=a);return ko.a.c(b)}function r(a,c,b){a=ko.a.r(ko.a.c(a),function(d){return l(d,b)==c});if(a.length!=1)throw Error("When calling ko.update*, the key '"+c+"' was not found or not unique!");return a[0]}function y(a,
c){return ko.a.u(ko.a.c(a),function(b){return c?l(b,c):b})}function z(a,c,b,d){var e=y(c,b),f=y(a,b);e=ko.a.v(f,e);f=0;for(var n=e.length;f<n;f++){var h=e[f];switch(h.status){case "added":h=r(ko.a.c(c),h.value,b);d("added",h);break;case "retained":h=r(c,h.value,b);d("retained",h);break;case "deleted":h=r(ko.a.c(a),h.value,b);d("deleted",h)}}}function x(a,c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function v(a,c,b){b=b||new w;a=c(a);var d=ko.a.c(a);if(!(j(d)=="object"&&
d!==null&&d!==undefined))return a;b.save(a,a);x(d,function(e){var f=d[e];switch(j(ko.a.c(f))){case "object":case "undefined":var n=b.f(f);d[e]=n!==undefined?n:v(f,c,b);break;default:d[e]=c(f)}});return a}function w(){var a=[],c=[];this.save=function(b,d){var e=ko.a.l(a,b);if(e>=0)c[e]=d;else{a.push(b);c.push(d)}};this.f=function(b){b=ko.a.l(a,b);return b>=0?c[b]:undefined}}ko.b={};var u=0,t,s;ko.b.h=function(a,c,b){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");
var d=c;d=d||{};if(d.create instanceof Function||d.key instanceof Function||d.g instanceof Function)d={"":d};c=d;d=i(b,a,c);d.__ko_mapping__=d.__ko_mapping__||{};d.__ko_mapping__=c;return d};ko.b.m=function(a,c){var b=ko.a.o(a);return ko.b.h(b,c)};ko.b.k=function(a,c){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");var b=a.__ko_mapping__;if(!b)throw Error("The object you are trying to update was not created by a 'fromJS' or 'fromJSON' mapping!");
return i(a,c,b)};ko.b.q=function(a,c,b){c=ko.a.o(c);return ko.b.k(a,c,b)};ko.b.i=function(a){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");return v(a,function(c){return ko.a.c(c)})};ko.b.toJSON=function(a){a=ko.b.i(a);return ko.a.C(a)};ko.d("ko.mapping",ko.b);ko.d("ko.mapping.fromJS",ko.b.h);ko.d("ko.mapping.fromJSON",ko.b.m);ko.d("ko.mapping.updateFromJS",ko.b.k);ko.d("ko.mapping.updateFromJSON",ko.b.q);ko.d("ko.mapping.toJS",ko.b.i);ko.d("ko.mapping.toJSON",
ko.b.toJSON)})();
