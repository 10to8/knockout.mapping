// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.e=function(m,p){for(var i=m.split("."),n=window,l=0;l<i.length-1;l++)n=n[i[l]];n[i[i.length-1]]=p};ko.v=function(m,p,i){m[p]=i};
(function(){function m(a){if(a&&typeof a==="object"&&a.constructor.toString().match(/date/i)!==null)return"date";return typeof a}function p(a){return a}function i(a,b,c,f,d){function g(e){_options={create:c.create};return ko.a.c(ko.b.h(e,_options))}if(a===undefined)return g(b);f=f||new t;if(f.j(b))return a;f.save(b,a);if(ko.a.c(a)instanceof Array){d=d||"root";var h=p;if(c.d[d])h=c.d[d];u(ko.a.c(a),b,d,h,function(e,j){switch(e){case "added":var o=g(j);a.push(o);break;case "retained":o=l(a,n(j,h),h);
i(o,j,c,f);break;case "deleted":o=l(a,n(j,h),h);a.remove(o)}})}else if(m(a)=="object"&&a!==null&&a!==undefined)v(b,function(e){i(a[e],b[e],c,f,e)});else if(ko.w(a))a(ko.a.c(b));else a=ko.a.c(b);return a}function n(a,b){var c=a;if(b)c=b(a);return ko.a.c(c)}function l(a,b,c){a=ko.a.r(ko.a.c(a),function(f){return n(f,c)==b});if(a.length!=1)throw Error("When calling ko.update*, the key '"+b+"' was not found or not unique!");return a[0]}function w(a,b){return ko.a.t(ko.a.c(a),function(c){return b?n(c,
b):c})}function u(a,b,c,f,d){c=w(b,f);var g=w(a,f);c=ko.a.u(g,c);g=0;for(var h=c.length;g<h;g++){var e=c[g];switch(e.status){case "added":e=l(ko.a.c(b),e.value,f);d("added",e);break;case "retained":e=l(b,e.value,f);d("retained",e);break;case "deleted":e=l(ko.a.c(a),e.value,f);d("deleted",e)}}}function v(a,b){if(a instanceof Array)for(var c=0;c<a.length;c++)b(c);else for(c in a)b(c)}function x(a,b){a=ko.a.c(a);if(b)return a;if(a instanceof Array)return ko.A(a);if(m(a)=="object"&&a!==null)return a;
return ko.z(a)}function s(a,b,c,f,d){c=c||new t;a=b.i(a);if(!(m(a)=="object"&&a!==null&&a!==undefined)){var g=b.g(a,f);return g}d=d||"root";var h=a instanceof Array,e=h?[]:{};if(b.create[d])g=b.create[d](a,d);g||(g=b.g(e,f));if(h){var j=b.f[d],o=[];if(j){j instanceof Array||(j=[j]);g.C(function(q){u(o,q,d,b.d[d],function(r,k){ko.a.s(j,function(y){y(r,k)})});o=q.slice(0)})}}if(g===undefined)throw Error("Create callback did not return an object!");c.save(a,g);v(a,function(q){var r=b.i(a[q]),k;switch(m(r)){case "boolean":case "number":case "string":case "function":case "date":k=
b.g(r,h);break;case "object":case "undefined":k=c.j(r);k=k!==undefined?k:s(r,b,c,h,q)}if(h){g.push(k);g.o&&g.o(k)}else e[q]=k});return g}function t(){var a=[],b=[];this.save=function(c,f){var d=ko.a.m(a,c);if(d>=0)b[d]=f;else{a.push(c);b.push(f)}};this.j=function(c){c=ko.a.m(a,c);return c>=0?b[c]:undefined}}ko.b={};ko.b.h=function(a,b){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");b=b||{};b.create=b.create||{};b.d=b.d||{};b.f=b.f||{};b.i=p;b.g=
x;return s(a,b)};ko.b.n=function(a,b){var c=ko.a.p(a);return ko.b.h(c,b)};ko.b.l=function(a,b,c){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");c=c||{};c.create=c.create||{};c.d=c.d||{};c.f=c.f||{};return i(a,b,c)};ko.b.q=function(a,b,c){b=ko.a.p(b);return ko.b.l(a,b,c)};ko.b.k=function(a){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");options={};options.create=
options.create||{};options.d=options.d||{};options.f=options.f||{};options.i=function(b){return ko.a.c(b)};options.g=p;return s(a,options)};ko.b.toJSON=function(a){a=ko.b.k(a);return ko.a.B(a)};ko.e("ko.mapping",ko.b);ko.e("ko.mapping.fromJS",ko.b.h);ko.e("ko.mapping.fromJSON",ko.b.n);ko.e("ko.mapping.updateFromJS",ko.b.l);ko.e("ko.mapping.updateFromJSON",ko.b.q);ko.e("ko.mapping.toJS",ko.b.k);ko.e("ko.mapping.toJSON",ko.b.toJSON)})();
