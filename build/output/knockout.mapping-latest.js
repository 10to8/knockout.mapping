// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.d=function(r,j){for(var h=r.split("."),k=window,o=0;o<h.length-1;o++)k=k[h[o]];k[h[h.length-1]]=j};ko.v=function(r,j,h){r[j]=h};
(function(){function r(){ko.i=function(a,b,c){c=c||{};c.u=true;a=new t(a,b,c);a.m=t;z.push(a);return a}}function j(a){if(a&&typeof a==="object"&&a.constructor==(new Date).constructor)return"date";return typeof a}function h(a,b,c){u||(z=[]);u++;a=k(a,b,c);u--;u||x(a,function(d){d&&d.m==t&&d.evaluate();return d});return a}function k(a,b,c,d,e,f){var l=ko.a.b(b)instanceof Array;if(ko.a.b(a)&&ko.a.b(a)[p])c=ko.a.b(a)[p];d=d||new A;if(d.g(b))return a;e=e||"";if(l){ko.w(a)||(a=ko.B([]));l=[];var m=function(g){return g};
if(c[e]&&c[e].key)m=c[e].key;var v=B(ko.a.b(a),m).sort(),s=B(b,m).sort();v=ko.a.t(v,s);s=[];for(var y=0,E=v.length;y<E;y++){var q=v[y];switch(q.status){case "added":var i=w(ko.a.b(b),q.value,m),n=ko.a.b(k(undefined,i,c,d,e,f));i=ko.a.f(ko.a.b(b),i);s[i]=n;break;case "retained":i=w(ko.a.b(b),q.value,m);n=w(a,q.value,m);k(n,i,c,d,e,f);i=ko.a.f(ko.a.b(b),i);s[i]=n;break;case "deleted":n=w(a,q.value,m);a.remove(n)}l.push({event:q.status,item:n})}a(s);c[e]&&c[e].h&&ko.a.n(l,function(g){c[e].h(g.event,
g.item)})}else if(j(b)=="object"&&b!==null&&b!==undefined){if(!a)if(c[e]&&c[e].create instanceof Function){r();f=c[e].create(b,f);ko.i=t;return f}else a={};d.save(b,a);C(b,function(g){var D=d.g(b[g]);a[g]=D?D:k(a[g],b[g],c,d,g,a)})}else switch(j(b)){case "function":a=b;break;default:if(ko.z(a))a(ko.a.b(b));else a=ko.A(ko.a.b(b))}return a}function o(a,b){var c;if(b)c=b(a);c||(c=a);return ko.a.b(c)}function w(a,b,c){a=ko.a.r(ko.a.b(a),function(d){return o(d,c)==b});if(a.length!=1)throw Error("When calling ko.update*, the key '"+
b+"' was not found or not unique!");return a[0]}function B(a,b){return ko.a.s(ko.a.b(a),function(c){return b?o(c,b):c})}function C(a,b){if(a instanceof Array)for(var c=0;c<a.length;c++)b(c);else for(c in a)b(c)}function x(a,b,c){c=c||new A;a=b(a);var d=ko.a.b(a);if(!(j(d)=="object"&&d!==null&&d!==undefined))return a;c.save(a,a);C(d,function(e){var f=d[e];switch(j(ko.a.b(f))){case "object":case "undefined":var l=c.g(f);d[e]=l!==undefined?l:x(f,b,c);break;default:d[e]=b(f)}});return a}function A(){var a=
[],b=[];this.save=function(c,d){var e=ko.a.f(a,c);if(e>=0)b[e]=d;else{a.push(c);b.push(d)}};this.g=function(c){c=ko.a.f(a,c);return c>=0?b[c]:undefined}}ko.c={};var p="__ko_mapping__",u=0,t=ko.i,z;ko.c.j=function(a,b,c){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");var d=b;d=d||{};if(d.create instanceof Function||d.key instanceof Function||d.h instanceof Function)d={"":d};b=d;d=h(c,a,b);d[p]=d[p]||{};d[p]=b;return d};ko.c.o=function(a,b){var c=
ko.a.p(a);return ko.c.j(c,b)};ko.c.l=function(a,b){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");var c=a[p];if(!c)throw Error("The object you are trying to update was not created by a 'fromJS' or 'fromJSON' mapping!");return h(a,b,c)};ko.c.q=function(a,b,c){b=ko.a.p(b);return ko.c.l(a,b,c)};ko.c.k=function(a,b){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");
b=b||{};b.e=b.e||[];if(!(b.e instanceof Array))b.e=[b.e];return x(a,function(c){ko.a.n(b.e,function(d){c[d]&&delete c[d]});return ko.a.b(c)})};ko.c.toJSON=function(a,b){var c=ko.c.k(a);return ko.a.C(c,b)};ko.d("ko.mapping",ko.c);ko.d("ko.mapping.fromJS",ko.c.j);ko.d("ko.mapping.fromJSON",ko.c.o);ko.d("ko.mapping.updateFromJS",ko.c.l);ko.d("ko.mapping.updateFromJSON",ko.c.q);ko.d("ko.mapping.toJS",ko.c.k);ko.d("ko.mapping.toJSON",ko.c.toJSON)})();
