// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.d=function(o,i){for(var j=o.split("."),m=window,k=0;k<j.length-1;k++)m=m[j[k]];m[j[j.length-1]]=i};ko.w=function(o,i,j){o[i]=j};
(function(){function o(){q=ko.e;ko.e=function(){var a=arguments,c,b={j:ko.n(false)},d=new q(function(){if(b.j()){if(!c){c=q.apply(this,a);b.e=c}return c()}});b.p=d;r.push(b);return d}}function i(a){if(a&&typeof a==="object"&&a.constructor==(new Date).constructor)return"date";return typeof a}function j(a){a=a||{};a.create=a.create;if(a.create instanceof Function)a.create={"":a.create};a.key=a.key||function(){};a.f=a.f;return a}function m(a,c,b){if(!s){r=[];o()}s++;a=k(a,c,b);s--;if(!s){ko.e=q;r.length&&
v(a,function(d){var e=ko.a.s(r,function(g){return g.p==d},this);if(e){e.j(true);return e.e}else return d})}return a}function k(a,c,b,d,e,g){var h=ko.a.c(c)instanceof Array;d=d||new w;if(d.g(c))return a;e=e||"";if(h){ko.z(a)||(a=ko.B([]));var t=[];z(ko.a.c(a),c,e,b.key,function(f,l){switch(f){case "added":var n=ko.a.c(k(undefined,l,b,d,e,g));a.push(n);break;case "retained":n=p(a,u(l,e,b.key),e,b.key);k(n,l,b,d,e,g);break;case "deleted":n=p(a,u(l,e,b.key),e,b.key);a.remove(n)}t.push({event:f,item:n})});
b.f&&ko.a.t(t,function(f){b.f(f.event,f.item,e)})}else if(i(c)=="object"&&c!==null&&c!==undefined){if(!a)if(b.create&&b.create[e]instanceof Function)return b.create[e](c,g);else a={};d.save(c,a);x(c,function(f){var l=d.g(c[f]);a[f]=l?l:k(a[f],c[f],b,d,e?e+"."+f:f,a)})}else switch(i(c)){case "function":a=c;break;default:if(ko.A(a))a(ko.a.c(c));else a=ko.n(ko.a.c(c))}return a}function u(a,c,b){var d;if(b)d=b(a,c);d||(d=a);return ko.a.c(d)}function p(a,c,b,d){a=ko.a.r(ko.a.c(a),function(e){return u(e,
b,d)==c});if(a.length!=1)throw Error("When calling ko.update*, the key '"+c+"' was not found or not unique!");return a[0]}function y(a,c,b){return ko.a.u(ko.a.c(a),function(d){return b?u(d,c,b):d})}function z(a,c,b,d,e){var g=y(c,b,d),h=y(a,b,d);g=ko.a.v(h,g);h=0;for(var t=g.length;h<t;h++){var f=g[h];switch(f.status){case "added":f=p(ko.a.c(c),f.value,b,d);e("added",f);break;case "retained":f=p(c,f.value,b,d);e("retained",f);break;case "deleted":f=p(ko.a.c(a),f.value,b,d);e("deleted",f)}}}function x(a,
c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function v(a,c,b){b=b||new w;a=c(a);var d=ko.a.c(a);if(!(i(d)=="object"&&d!==null&&d!==undefined))return a;b.save(a,a);x(d,function(e){var g=d[e];switch(i(ko.a.c(g))){case "object":case "undefined":var h=b.g(g);d[e]=h!==undefined?h:v(g,c,b);break;default:d[e]=c(g)}});return a}function w(){var a=[],c=[];this.save=function(b,d){var e=ko.a.l(a,b);if(e>=0)c[e]=d;else{a.push(b);c.push(d)}};this.g=function(b){b=ko.a.l(a,b);return b>=
0?c[b]:undefined}}ko.b={};var s=0,r,q;ko.b.h=function(a,c){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");c=j(c);var b=m(undefined,a,c);b.__ko_mapping__=b.__ko_mapping__||{};b.__ko_mapping__=c;return b};ko.b.m=function(a,c){var b=ko.a.o(a);return ko.b.h(b,c)};ko.b.k=function(a,c){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");var b=a.__ko_mapping__;if(!b)throw Error("The object you are trying to update was not created by a 'fromJS' or 'fromJSON' mapping!");
return m(a,c,b)};ko.b.q=function(a,c,b){c=ko.a.o(c);return ko.b.k(a,c,b)};ko.b.i=function(a){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");return v(a,function(c){return ko.a.c(c)})};ko.b.toJSON=function(a){a=ko.b.i(a);return ko.a.C(a)};ko.d("ko.mapping",ko.b);ko.d("ko.mapping.fromJS",ko.b.h);ko.d("ko.mapping.fromJSON",ko.b.m);ko.d("ko.mapping.updateFromJS",ko.b.k);ko.d("ko.mapping.updateFromJSON",ko.b.q);ko.d("ko.mapping.toJS",ko.b.i);ko.d("ko.mapping.toJSON",
ko.b.toJSON)})();
