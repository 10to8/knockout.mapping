/// Knockout Mapping plugin v2.3.3
/// (c) 2012 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
/// License: MIT (http://www.opensource.org/licenses/mit-license.php)
(function(e){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?e(require("knockout"),exports):"function"===typeof define&&define.amd?define(["knockout","exports"],e):e(ko,ko.mapping={})})(function(e,f){function z(b,c){var a,d;for(d in c)if(c.hasOwnProperty(d)&&c[d])if(a=f.getType(b[d]),d&&b[d]&&"array"!==a&&"string"!==a)z(b[d],c[d]);else if("array"===f.getType(b[d])&&"array"===f.getType(c[d])){a=b;for(var e=d,h=b[d],s=c[d],u={},g=h.length-1;0<=g;--g)u[h[g]]=h[g];for(g=
s.length-1;0<=g;--g)u[s[g]]=s[g];h=[];s=void 0;for(s in u)h.push(u[s]);a[e]=h}else b[d]=c[d]}function E(b,c){var a={};z(a,b);z(a,c);return a}function B(b,c){for(var a=E({},b),d=L.length-1;0<=d;d--){var e=L[d];a[e]&&(a[""]instanceof Object||(a[""]={}),a[""][e]=a[e],delete a[e])}c&&(a.ignore=q(c.ignore,a.ignore),a.include=q(c.include,a.include),a.copy=q(c.copy,a.copy));a.ignore=q(a.ignore,i.ignore);a.include=q(a.include,i.include);a.copy=q(a.copy,i.copy);a.mappedProperties=a.mappedProperties||{};return a}
function q(b,c){"array"!==f.getType(b)&&(b="undefined"===f.getType(b)?[]:[b]);"array"!==f.getType(c)&&(c="undefined"===f.getType(c)?[]:[c]);return e.utils.arrayGetDistinctValues(b.concat(c))}function F(b,c,a,d,k,h,s){var u="array"===f.getType(e.utils.unwrapObservable(c)),h=h||"";if(f.isMapped(b))var g=e.utils.unwrapObservable(b)[r],a=E(g,a);var l=function(){return a[d]&&a[d].create instanceof Function},i=function(b){var f=G,g=e.dependentObservable;e.dependentObservable=function(a,b,c){c=c||{};a&&
"object"==typeof a&&(c=a);var d=c.deferEvaluation,M=!1;c.deferEvaluation=!0;a=new H(a,b,c);if(!d){var g=a,d=e.dependentObservable;e.dependentObservable=H;a=e.isWriteableObservable(g);e.dependentObservable=d;a=H({read:function(){M||(e.utils.arrayRemoveItem(f,g),M=!0);return g.apply(g,arguments)},write:a&&function(a){return g(a)},deferEvaluation:!0});f.push(a)}return a};e.dependentObservable.fn=H.fn;e.computed=e.dependentObservable;b=e.utils.unwrapObservable(k)instanceof Array?a[d].create({data:b||
c,parent:s,skip:N}):a[d].create({data:b||c,parent:s});e.dependentObservable=g;e.computed=e.dependentObservable;return b},v=function(){return a[d]&&a[d].update instanceof Function},w=function(b,f){var g={data:f||c,parent:s,target:e.utils.unwrapObservable(b)};e.isWriteableObservable(b)&&(g.observable=b);return a[d].update(g)};if(g=I.get(c))return g;d=d||"";if(u){var u=[],t=!1,j=function(a){return a};a[d]&&a[d].key&&(j=a[d].key,t=!0);e.isObservable(b)||(b=e.observableArray([]),b.mappedRemove=function(a){var c=
"function"==typeof a?a:function(b){return b===j(a)};return b.remove(function(a){return c(j(a))})},b.mappedRemoveAll=function(a){var c=C(a,j);return b.remove(function(a){return-1!=e.utils.arrayIndexOf(c,j(a))})},b.mappedDestroy=function(a){var c="function"==typeof a?a:function(b){return b===j(a)};return b.destroy(function(a){return c(j(a))})},b.mappedDestroyAll=function(a){var c=C(a,j);return b.destroy(function(a){return-1!=e.utils.arrayIndexOf(c,j(a))})},b.mappedIndexOf=function(a){var c=C(b(),j),
a=j(a);return e.utils.arrayIndexOf(c,a)},b.mappedCreate=function(a){if(-1!==b.mappedIndexOf(a))throw Error("There already is an object with the key that you specified.");var c=l()?i(a):a;v()&&(a=w(c,a),e.isWriteableObservable(c)?c(a):c=a);b.push(c);return c});var g=C(e.utils.unwrapObservable(b),j).sort(),n=C(c,j);t&&n.sort();var t=e.utils.compareArrays(g,n),g={},q,A=e.utils.unwrapObservable(c),y={},z=!0,n=0;for(q=A.length;n<q;n++){var p=j(A[n]);if(void 0===p||p instanceof Object){z=!1;break}y[p]=
A[n]}var A=[],B=0,n=0;for(q=t.length;n<q;n++){var p=t[n],m,x=h+"["+n+"]";switch(p.status){case "added":var D=z?y[p.value]:J(e.utils.unwrapObservable(c),p.value,j);m=F(void 0,D,a,d,b,x,k);l()||(m=e.utils.unwrapObservable(m));x=O(e.utils.unwrapObservable(c),D,g);m===N?B++:A[x-B]=m;g[x]=!0;break;case "retained":D=z?y[p.value]:J(e.utils.unwrapObservable(c),p.value,j);m=J(b,p.value,j);F(m,D,a,d,b,x,k);x=O(e.utils.unwrapObservable(c),D,g);A[x]=m;g[x]=!0;break;case "deleted":m=J(b,p.value,j)}u.push({event:p.status,
item:m})}b(A);a[d]&&a[d].arrayChanged&&e.utils.arrayForEach(u,function(b){a[d].arrayChanged(b.event,b.item)})}else if(P(c)){b=e.utils.unwrapObservable(b);if(!b){if(l())return t=i(),v()&&(t=w(t)),t;if(v())return w(t);b={}}v()&&(b=w(b));I.save(c,b);if(v())return b;Q(c,function(d){var f=h.length?h+"."+d:d;if(-1==e.utils.arrayIndexOf(a.ignore,f))if(-1!=e.utils.arrayIndexOf(a.copy,f))b[d]=c[d];else{var g=I.get(c[d]),k=F(b[d],c[d],a,d,b,f,b),g=g||k;if(e.isWriteableObservable(b[d]))b[d](e.utils.unwrapObservable(g));
else b[d]=g;a.mappedProperties[f]=!0}})}else switch(f.getType(c)){case "function":v()?e.isWriteableObservable(c)?(c(w(c)),b=c):b=w(c):b=c;break;default:if(e.isWriteableObservable(b))return m=v()?w(b):e.utils.unwrapObservable(c),b(m),m;l()||v();b=l()?i():e.observable(e.utils.unwrapObservable(c));v()&&b(w(b))}return b}function O(b,c,a){for(var d=0,e=b.length;d<e;d++)if(!0!==a[d]&&b[d]===c)return d;return null}function R(b,c){var a;c&&(a=c(b));"undefined"===f.getType(a)&&(a=b);return e.utils.unwrapObservable(a)}
function J(b,c,a){for(var b=e.utils.unwrapObservable(b),d=0,f=b.length;d<f;d++){var h=b[d];if(R(h,a)===c)return h}throw Error("When calling ko.update*, the key '"+c+"' was not found!");}function C(b,c){return e.utils.arrayMap(e.utils.unwrapObservable(b),function(a){return c?R(a,c):a})}function Q(b,c){if("array"===f.getType(b))for(var a=0;a<b.length;a++)c(a);else for(a in b)c(a)}function P(b){var c=f.getType(b);return("object"===c||"array"===c)&&null!==b}function T(){var b=[],c=[];this.save=function(a,
d){var f=e.utils.arrayIndexOf(b,a);0<=f?c[f]=d:(b.push(a),c.push(d))};this.get=function(a){a=e.utils.arrayIndexOf(b,a);return 0<=a?c[a]:void 0}}function S(){var b={},c=function(a){var c;try{c=a}catch(e){c="$$$"}a=b[c];void 0===a&&(a=new T,b[c]=a);return a};this.save=function(a,b){c(a).save(a,b)};this.get=function(a){return c(a).get(a)}}var r="__ko_mapping__",H=e.dependentObservable,K=0,G,I,L=["create","update","key","arrayChanged"],N={},y={include:["_destroy"],ignore:[],copy:[]},i=y;f.isMapped=function(b){return(b=
e.utils.unwrapObservable(b))&&b[r]};f.fromJS=function(b){if(0==arguments.length)throw Error("When calling ko.fromJS, pass the object you want to convert.");window.setTimeout(function(){K=0},0);K++||(G=[],I=new S);var c,a;2==arguments.length&&(arguments[1][r]?a=arguments[1]:c=arguments[1]);3==arguments.length&&(c=arguments[1],a=arguments[2]);a&&(c=E(c,a[r]));c=B(c);var d=F(a,b,c);a&&(d=a);--K||window.setTimeout(function(){for(;G.length;){var a=G.pop();a&&a()}},0);d[r]=E(d[r],c);return d};f.fromJSON=
function(b){var c=e.utils.parseJson(b);arguments[0]=c;return f.fromJS.apply(this,arguments)};f.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");};f.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");};f.toJS=function(b,c){i||f.resetDefaultOptions();if(0==arguments.length)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");
if("array"!==f.getType(i.ignore))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if("array"!==f.getType(i.include))throw Error("ko.mapping.defaultOptions().include should be an array.");if("array"!==f.getType(i.copy))throw Error("ko.mapping.defaultOptions().copy should be an array.");c=B(c,b[r]);return f.visitModel(b,function(a){return e.utils.unwrapObservable(a)},c)};f.toJSON=function(b,c){var a=f.toJS(b,c);return e.utils.stringifyJson(a)};f.defaultOptions=function(){if(0<arguments.length)i=
arguments[0];else return i};f.resetDefaultOptions=function(){i={include:y.include.slice(0),ignore:y.ignore.slice(0),copy:y.copy.slice(0)}};f.getType=function(b){if(b&&"object"===typeof b){if(b.constructor==(new Date).constructor)return"date";if("[object Array]"===Object.prototype.toString.call(b))return"array"}return typeof b};f.visitModel=function(b,c,a){a=a||{};a.visitedObjects=a.visitedObjects||new S;var d,k=e.utils.unwrapObservable(b);if(P(k))a=B(a,k[r]),c(b,a.parentName),d="array"===f.getType(k)?
[]:{};else return c(b,a.parentName);a.visitedObjects.save(b,d);var h=a.parentName;Q(k,function(b){if(!(a.ignore&&-1!=e.utils.arrayIndexOf(a.ignore,b))){var i=k[b],g=a,l=h||"";"array"===f.getType(k)?h&&(l+="["+b+"]"):(h&&(l+="."),l+=b);g.parentName=l;if(!(-1===e.utils.arrayIndexOf(a.copy,b)&&-1===e.utils.arrayIndexOf(a.include,b)&&k[r]&&k[r].mappedProperties&&!k[r].mappedProperties[b]&&"array"!==f.getType(k)))switch(f.getType(e.utils.unwrapObservable(i))){case "object":case "array":case "undefined":g=
a.visitedObjects.get(i);d[b]="undefined"!==f.getType(g)?g:f.visitModel(i,c,a);break;default:d[b]=c(i,a.parentName)}}});return d}});
