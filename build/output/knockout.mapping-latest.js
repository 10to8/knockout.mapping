// Knockout Mapping plugin v0.5
// (c) 2010 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.d=function(u,n){for(var k=u.split("."),o=window,s=0;s<k.length-1;s++)o=o[k[s]];o[k[k.length-1]]=n};ko.C=function(u,n,k){u[n]=k};
(function(){function u(){ko.l=function(a,c,b){b=b||{};b.B=true;a=new w(a,c,b);a.q=w;A.push(a);return a}}function n(a){if(a&&typeof a==="object"&&a.constructor==(new Date).constructor)return"date";return typeof a}function k(a,c,b){x||(A=[]);x++;a=o(a,c,b);x--;x||ko.b.h(a,function(d){d&&d.q==w&&d.evaluate();return d});return a}function o(a,c,b,d,f,p){var h=ko.a.c(c)instanceof Array;if(ko.b.n(a))b=ko.a.c(a)[r];d=d||new B;if(d.i(c))return a;f=f||"";if(h){p=[];var g=function(e){return e};if(b[f]&&b[f].key)g=
b[f].key;if(!ko.D(a)){a=ko.M([]);a.J=function(e){var i=typeof e=="function"?e:function(j){return j===g(e)};return a.remove(function(j){return i(g(j))})};a.K=function(e){var i=v(e,g);return a.remove(function(j){return ko.a.e(i,g(j))!=-1})};a.G=function(e){var i=typeof e=="function"?e:function(j){return j===g(e)};return a.r(function(j){return i(g(j))})};a.H=function(e){var i=v(e,g);return a.r(function(j){return ko.a.e(i,g(j))!=-1})};a.I=function(e){var i=v(a(),g);e=g(e);return ko.a.e(i,e)}}h=v(ko.a.c(a),
g).sort();var q=v(c,g).sort();h=ko.a.A(h,q);q=[];for(var z=0,D=h.length;z<D;z++){var t=h[z];switch(t.status){case "added":var l=y(ko.a.c(c),t.value,g),m=ko.a.c(o(undefined,l,b,d,f,a));l=ko.a.e(ko.a.c(c),l);q[l]=m;break;case "retained":l=y(ko.a.c(c),t.value,g);m=y(a,t.value,g);o(m,l,b,d,f,a);l=ko.a.e(ko.a.c(c),l);q[l]=m;break;case "deleted":m=y(a,t.value,g);a.remove(m)}p.push({event:t.status,item:m})}a(q);b[f]&&b[f].k&&ko.a.w(p,function(e){b[f].k(e.event,e.item)})}else if(n(c)=="object"&&c!==null&&
c!==undefined){if(!a)if(b[f]&&b[f].create instanceof Function){u();m=b[f].create({data:c,parent:p});ko.l=w;return m}else a={};d.save(c,a);C(c,function(e){var i=d.i(c[e]);a[e]=i?i:o(a[e],c[e],b,d,e,a)})}else switch(n(c)){case "function":a=c;break;default:if(ko.F(a))a(ko.a.c(c));else a=ko.L(ko.a.c(c))}return a}function s(a,c){var b;if(c)b=c(a);b||(b=a);return ko.a.c(b)}function y(a,c,b){a=ko.a.v(ko.a.c(a),function(d){return s(d,b)==c});if(a.length!=1)throw Error("When calling ko.update*, the key '"+
c+"' was not found or not unique!");return a[0]}function v(a,c){return ko.a.z(ko.a.c(a),function(b){return c?s(b,c):b})}function C(a,c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function B(){var a=[],c=[];this.save=function(b,d){var f=ko.a.e(a,b);if(f>=0)c[f]=d;else{a.push(b);c.push(d)}};this.i=function(b){b=ko.a.e(a,b);return b>=0?c[b]:undefined}}ko.b={};var r="__ko_mapping__",x=0,w=ko.l,A;ko.b.m=function(a,c,b){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");
var d=c;d=d||{};if(d.create instanceof Function||d.key instanceof Function||d.k instanceof Function)d={"":d};c=d;d=k(b,a,c);d[r]=d[r]||{};d[r]=c;return d};ko.b.s=function(a,c){var b=ko.a.t(a);return ko.b.m(b,c)};ko.b.n=function(a){return(a=ko.a.c(a))&&a[r]};ko.b.p=function(a,c){if(arguments.length<2)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");if(!a)throw Error("The object is undefined.");if(!a[r])throw Error("The object you are trying to update was not created by a 'fromJS' or 'fromJSON' mapping.");
return k(a,c,a[r])};ko.b.u=function(a,c,b){c=ko.a.t(c);return ko.b.p(a,c,b)};ko.b.o=function(a,c){if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");c=c||{};c.g=c.g||[];if(!(c.g instanceof Array))c.g=[c.g];return ko.b.h(a,function(b){return ko.a.c(b)},c)};ko.b.toJSON=function(a,c){var b=ko.b.o(a);return ko.a.N(b,c)};ko.b.h=function(a,c,b){b=b||{};b.j=b.j||new B;var d,f=ko.a.c(a);if(n(f)=="object"&&f!==null&&f!==undefined){c(a,b.f);d=f instanceof
Array?[]:{}}else return c(a,b.f);b.j.save(a,d);var p=b.f;C(f,function(h){if(!(b.g&&ko.a.e(b.g,h)!=-1)){var g=f[h];b.f=p||"";if(f instanceof Array){if(p)b.f+="["+h+"]"}else{if(p)b.f+=".";b.f+=h}switch(n(ko.a.c(g))){case "object":case "undefined":var q=b.j.i(g);d[h]=q!==undefined?q:ko.b.h(g,c,b);break;default:d[h]=c(g,b.f)}}});return d};ko.d("ko.mapping",ko.b);ko.d("ko.mapping.fromJS",ko.b.m);ko.d("ko.mapping.fromJSON",ko.b.s);ko.d("ko.mapping.isMapped",ko.b.n);ko.d("ko.mapping.toJS",ko.b.o);ko.d("ko.mapping.toJSON",
ko.b.toJSON);ko.d("ko.mapping.updateFromJS",ko.b.p);ko.d("ko.mapping.updateFromJSON",ko.b.u);ko.d("ko.mapping.visitModel",ko.b.h)})();
